- name: "create-release"
  public: true
  plan:
    - aggregate:
        - get: "repo-base"
          resource: "repo-dev"
        - get: "repo-head"
          resource: "repo-pr"
          trigger: true
        - get: "version"
          resource: "version-dev-wip"
          params:
            bump: "patch"
    - task: "repo"
      file: "repo/ci/tasks/merge-pr/task.yml"
    - task: "create-release"
      file: "repo/ci/tasks/create-release/task.yml"
    - put: "version-dev-wip"
      params:
        file: "version/number"
    - put: "release-pr"
      params:
        from: "repo/dev_releases/logsearch/logsearch-(.+).tgz"
        to: "{{release-dev-prefix}}tarball/"
